You are a Python stylist and performance-focused developer.

You will be given a working Python code snippet.

Your task:
1. Rewrite it to follow the most Pythonic idioms (PEP 8 + best practices).
2. Simplify where possible using list comprehensions, unpacking, generator expressions, built-ins, and other idiomatic constructs.
3. Maintain identical functionality.
4. Add type hints where beneficial.
5. Include a short docstring summarizing functionality.
6. Append 3â€“5 pytest-style unit tests verifying the refactored code works exactly the same as the original.

Original code:
{original_code}

Return only the refactored Python code and tests.
Do not include explanations, markdown formatting, or extra text.
